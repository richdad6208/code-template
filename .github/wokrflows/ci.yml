name: Build & Deploy Docker

on:
    push:
        branches: [main, dev]

jobs:
    build:
        runs-on: ubuntu-latest

    steps:
        - name: ğŸ“¦ Checkout repository
          uses: actions/checkout@v3

        - name: ğŸ— Build Docker image
          run: docker build -t image-template .

        - name: ğŸ§¼ Stop and remove existing container
          run: docker rm -f container-template || true

        - name: ğŸ§¹ Clean up dangling images
          run: docker image prune -f

        - name: ğŸš€ Run new container
          run: docker run -d -p 3000:3000 --name container-template image-template
